-- 학생 

-- 회원관리 > 학생 > 로그인
-- Map<String, String>
-- 학생DTO(ID,NAME)
-- Session ID NAME
SELECT ID,NAME,S_CHECK FROM STUDENT
	 WHERE ID='01011111111' AND PW='1111';

-- 회원관리 > 학생 > 비밀번호 초기화
-- Map<String, String>
UPDATE STUDENT SET PW ='1234' WHERE ID='01011111111';

-- 회원관리 > 학생 > 회원탈퇴
UPDATE STUDENT SET DELFLAG = 'N' WHERE ID='01011111111';

-- 회원관리 > 학생 > 참여 과정 조회    -> 기능이 진짜 맞는건지??
-- String ID
-- 학생DTO(ID,NAME, GENDER,BIRTH, ADDR+ (COURSENAME) 
SELECT ID, NAME, GENDER, BIRTH, ADDR, COURSENAME
  FROM STUDENT JOIN COURSE
  USING (ID) WHERE  ID='01011111111';
 
-- 회원 관리 > 학생 > 회원정보 조회
SELECT ID, NAME, GENDER, BIRTH, ADDR
	FROM STUDENT WHERE ID = '';

-- 회원 관리 > 학생 > 수강중인 과정 조회 ( 참여 과정이 여러개일 경우 사용자 정보를 여러번 띄워야 하는 불편함이 있기 때문에 따로 구분해서 뿌려주는게 낫다) 
SELECT COURSENAME, STARTDATE, ID, "TIME", COURSECNT
	FROM USERCOURSE U JOIN COURSE C
	USING COURSECODE WHERE U.ID = '01011111111';
 
-- 회원관리 > 학생 > 사용자 정보 수정
-- 학생DTO(ID,PW, NAME, GENDER, ADDR)
UPDATE STUDENT SET PW='0000', NAME='홍길동', GENDER='F', ADDR='서울시 강남'
 WHERE ID= '01011111111'
 
 ------------------------------------------------------------------------
 -- 강사 
 -- 회원관리 > 강사 > 로그인 
SELECT ID, NAME, COURSECODE 
	FROM TEACHER
		WHERE ID='' PW='';
 
-- 회원관리 > 강사 > 자기정보 조회 
SELECT ID, NAME, COURSECODE, PW 
	FROM TEACHER WHERE ID='';

-- 회원관리 > 강사 > 본인 과정 수강학생 조회
-- 강사로그인시 과정이 Session
 SELECT ID, NAME, GENDER, BIRTH, ADDR
 FROM STUDENT JOIN USERCOURSE
 using(id) WHERE COURSECODE = ''; -- 세션에 담겨있는 해당 강사의 COURSECODE
-- (SELECT COURSECODE FROM TEACHER WHERE id= '01012345678')
 
-- 회원관리 > 강사 > 자기 과정에 있는 과목 조회 
SELECT SUBJECTCODE, SUBJECTNAME, SUBJECTTYPE, "TYPE", "TIME"
	FROM SUBJECT S JOIN COURSESUBJECT C
	USING (SUBJECTCODE) WHERE C.SUBJECTCODE = SELECT SUBJECTCODE FROM COURSE_SUBJECT WHERE COURSECODE = ''; 
	-- 세션에 담긴 강사의 COURSECODE를 가져다 과정-과목 테이블을 통해 과목 테이블 목록을 보여준다 
	
-- 회원관리 > 강사 > 과목추가 
INSERT INTO SUBJECT(SUBJECTCODE,SUBJECTNAME,SUBJECTTYPE,"TYPE","TIME")
VALUES('','','','','');
	
-- 과정에 과목 추가 
INSERT INTO COURSE_SUBJECT (SEQ, COURSECODE, SUBJECTCODE, "TYPE", SUBJETTYPE, CONTENT )
VALUES(COURSE_SUBJECT_SEQ.NEXTVAL, '','','','','');

------------------------------------------------------------
-- 관리자 
-- 회원관리 > 관리자 > 회원가입 승인
-- 체크박기 기능
-- String[]
UPDATE STUDENT SET S_CHECK = 'Y' WHERE ID IN ('01011111111');

-- 회원관리 > 관리자 > 가입 미승인
DELETE FROM STUDENT WHERE ID IN ('01011111111');

-- 관리자 -> 강사 조회 -> 강사의 과정을 상세 -> 학생
 -- 강사 -> 과정 id -> 학생  
 SELECT ID, NAME, PW, GENDER, BIRTH, ADDR, S_CHECK
 FROM STUDENT JOIN USERCOURSE
 USING(ID) WHERE COURSECODE= 'C00001'; --강사ID
 
 -- 회원관리 > 관리자 > 가입 대기 신청중인 학생 조회 
 SELECT ID, NAME, PW, GENDER, BIRTH, ADDR
 	FROM STUDENT
 		WHERE S_CHECK='N';
 	
 -- 회원관리 > 관리자 > 신고글 조회 
 SELECT SEQ, TITLE, ID, REGDATE, READCOUNT
 	FROM FILEBOARD WHERE REPORT='Y';
 
 -- 회원관리 > 관리자 > 신고글 상세 조회 
 SELECT TITLE, CONTENT, ID, REGDATE, READCOUNT, REPORT, FILENAME, NEWFILENAME
 	FROM FILE_BOARD WHERE SEQ='';
 
-- 회원관리 > 관리자 > 회원정보 조회(학생)
SELECT ID, NAME, PW, GENDER, BIRTH, ADDR, DELFLAG
	FROM STUDENT WHERE S_CHECK = 'Y'
	ORDER BY DELFLAG DESC; -- 활동중인 회원 -> 비활동중인 회원 
	
-- 회원관리 > 관리자 > 회원정보 상세 조회(학생, 일반 정보 조회)	
SELECT ID, NAME, PW, GENDER, BIRTH, ADDR, DELFLAG, 
	(SELECT COURSENAME FROM COURSE WHERE COURSECODE = SELECT C.COURSECODE WHERE ID = '')
	FROM STUDENT S JOIN USERCOURSE C
	USING (ID) WHERE S.ID =''; -- 세션으로부터 사용자 ID를 받아온다 
	
-- 회원관리 > 관리자 > 회원정보 상세 조회(학생, 수강중인 과정 조회)
SELECT ID, (SELECT COURSENAME FROM COURSE WHERE COURSECODE = (
	SELECT COURSECODE FROM USERCOURSE WHERE ID=''))
	FROM STUDENT JOIN USERCOURSE
	USING ID WHERE ID = '';

-- 회원관리 > 관리자 > 학생에 과정 추가 
INSERT INTO USERCOURSE(ID, COURSECODE, REGDATE)
VALUES('','',SYSDATE);
	
-- 회원관리 > 관리자 > 회원정보 수정(학생)
UPDATE STUDENT SET ID ='', NAME='', PW='',GENDER='', BIRTH='',ADDR=''
	WHERE ID='';

-- 회원관리 > 관리자 > 회원 탈퇴(학생)
UPDATE STUDENT SET DELFLAG ='N' WHERE ID ='';
	
-- 회원관리 > 관리자 > 회원정보 조회(강사)
SELECT ID, NAME, PW, COURSECODE
	FROM TEACHER;

-- 회원관리 > 관리자 > 과정 추가 
INSERT INTO COURSE(COURSECODE, COURSENAME, STARTDATE, ID, "TIME", COURSECNT)
VALUES('','','','',SYSDATE,'');

-- 회원관리 > 관리자 > 강사 등록
INSERT INTO TEACHER(ID, NAME,PW,COURSECODE)
SET('','','','');
